# 테스트 주도 개발 - 켄트 벡

## TDD 리듬

- 재빨리 **작은** 테스트를 하나 추가한다.
- 모든 테스트를 실행하고, 실패하는 것을 확인한다. 🔴
- 코드에 변화를 준다.
- 모든 테스트를 실행하고, 성공하는 것을 확인한다. 🟢
  - 가짜로 구현하기: 상수로 반환하게 만들고 진짜 코드를 얻을 때까지 단계적으로 상수를 변수로 바꾸어 간다.
  - 명백한 구현 사용하기: 실제 구현을 입력한다.
  - 삼각측량(triangulation): 두 개 이상의 예제를 통해 코드를 일반화한다. 어떻게 리팩토링해야 하는지 전혀 감이 안 올 때만 삼각측량을 상요한다.
- 중복을 제거하기 위해 리팩토링한다. 🔵

## 화폐(Money) 예제

- 값 객체 패턴(value object pattern)
  - `Dollar` 객체와 같이 객체를 값처럼 쓰는 것을 말한다.
  - 값 객체에 대한 제약사항 중 하나는 객체의 인스턴스 변수가 생성자를 통해서 일단 설정된 후에는 결코 변하지 않는다는 것이다.
- 테스트 중단
  - 지금 하는 일을 중단하지 말아야 한다.
  - 하지만 짧은 중단이 필요할 경우에는 흔쾌히 받아들이는 편이다. (짧은 것만!)
  - 단, 하던 일을 중단하고 다른 일을 하는 상태에서 그 일을 또 중단하지는 않는다.
- 흥미로운 시간
  - 코드가 잘 작동할 거라는 믿음을 줄 수 있는 테스트 코드들이 있다.
  - 몇 분 동안 고민하는 대신 그냥 수정하고 테스트를 돌려서 컴퓨터에게 직접 물어보자.
  - 컴퓨터라면 10초에서 15초 사이에 대답할 수 있는 문제를 놓고 최고의 소프트웨어 엔지니어들이 5분에서 10분 동안 고민하곤 한다. 가끔은 그냥 컴퓨터에게 물어보는 것도 좋다.
- 지저분한 코드
  - 캐스팅(형변환).
  - 공용(public) 필드와 그 필드들에 대한 두 단계에 걸친 레퍼런스.
  - 클래스를 명시적으로 검사하는 코드(instanceof, getClass(), ...)가 있을 때에는 항상 다형성(polymorphism)을 사용하도록 바꾸는 것이 좋다.
- 키워드 매개 변수를 지원하는 언어에서는 의도를 명백히 표현할 수 있도록 문법 차원에서 지원을 해준다. `reduce(to="USD")`
  - Java와 같이 위치 매개 변수(positional parameters)만으로는 두 메서드가 어떻게 다른지에 대해 코드에 명확히 담아내는 것이 쉽지 않다. `reduce("USD")`

## 회고

- 다음에 할일은 무엇인가.
  - 작업을 끝낸 후에 Linter 같은 자동화된 코드 감정 프로그램을 실행한다. 뭔가 잊어먹는 일 없이 스트레스를 줄일 수 있다.
  - 할 일 목록이 빌 때가 그때까지 설계한 것을 검토하기에 적절한 시기다.
  - 질질 끌며 남아 있는 중복은 잠복성 디자인의 증후다.
- 메타포 - 설계 구조에 미치는 메타포의 엄청난 영향
- JUnit 사용도 - 언제 테스트를 실행했으며, JUnit을 어떻게 사용해 왔는가.
- 코드 메트릭스(metrics) - 결과 코드의 수치화.
- 프로세스 - 빨강/초록/리팩토링 순서에 대해 이야기했는데, 그렇다면 각 단계에서 얼마 만큼 작업해야 하는가.
- 테스트의 질 - 전통적인 테스트 메트릭스에 TDD 테스트가 어떻게 필적할 수 있는가.
  - 명령문 커버리지(statement coverage)
  - 결함 삽입(defect insertion)
- TDD를 가르칠 때 사람들이 자주 놀라는 세 가지
  - 테스트를 확실히 돌아가게 만든느 세 가지 접근법: 가짜로 구현하기, 삼각측량법, 명백하게 구현하기.
  - 설계를 주도하기 위한 방법으로 테스트 코드와 실제 코드 사이의 중복을 제거하기.
  - 길이 미끄러우면 속도를 줄이고 상황이 좋으면 속도를 높이는 식으로 테스트 사이의 간격을 조절할 수 있는 능력.

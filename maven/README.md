# Maven

- [Maven](#maven)
  - [철학](#철학)
  - [POM](#pom)
  - [POM Layers](#pom-layers)
  - [POM 설정](#pom-설정)
  - [라이프사이클](#라이프사이클)
    - [Clean Lifecycle](#clean-lifecycle)
    - [Default Lifecycle](#default-lifecycle)
    - [Site Lifecycle](#site-lifecycle)
  - [플러그인](#플러그인)
  - [References](#references)

## Demo

```shell
./mvnw clean package
```

## 철학

Maven은 **convention-over-configuration** 철학을 따른다.
[Convention over configuration](https://en.wikipedia.org/wiki/Convention_over_configuration)이란
개발자가 결정해야 하는 것들을 줄이려는 소프트웨어 디자인 패러다임이다.
해당 패러다임은 최소 놀람의 원리([principle of least astonishment](https://en.wikipedia.org/wiki/Principle_of_least_astonishment))을
목적으로 하는데 이는 시스템이 사용자가 예상하는 방식으로 동작해야 함을 말한다.

## POM

Maven은 POM(Project Object Model)을 사용하여 프로젝트를 관리한다.

## POM Layers

![POM Layers](https://cgunturme.files.wordpress.com/2020/05/maveneffectivepom.png?w=1024)

*[이미지 출처](https://foojay.io/today/understanding-apache-maven-part-2-pom-hierarchy/)*

- Maven Internal Defaults
  - Maven 소스 코드에 내장되어 있다.
- Maven Super POM
  - Maven 소스 코드에 내장되어 있다.
- Maven Global Settings
  - `${maven installation}/conf/settings.xml`
  - 모든 프로젝트에 적용되는 전역 설정 파일
- Maven User Settings
  - `${user.home}/.m2/settings.xml`
  - 특정 사용자가 관리하는 프로젝트들에 적용되는 설정 파일
- Parent / Bill-of-Material POMs
  - 해당 장치에 있거나 원격 리포지터리에 있거나 다양함.
- Project POM
  - `${project}/pom.xml`

## POM 설정

![Configuring Apache Maven](https://cgunturme.files.wordpress.com/2020/06/mavenconfiguration.png?w=1024)

*[이미지 출처](https://foojay.io/today/understanding-apache-maven-part-7-configuring-apache-maven/)*

## 라이프사이클

- [Lifecycle Reference](https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html#Lifecycle_Reference) - Maven

### Clean Lifecycle

| Phase        | Description                                                   |
| ------------ | ------------------------------------------------------------- |
| `pre-clean`  | execute processes needed prior to the actual project cleaning |
| `clean`      | remove all files generated by the previous build              |
| `post-clean` | execute processes needed to finalize the project cleaning     |

### Default Lifecycle

| Phase                     | Description                                                                                                                                             |
| ------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `validate`                | validate the project is correct and all necessary information is available                                                                              |
| `initialize`              | initialize build state, e.g. set properties or create directories.                                                                                      |
| `generate-sources`        | generate any source code for inclusion in compilation.                                                                                                  |
| `process-sources`         | process the source code, for example to filter any values.                                                                                              |
| `generate-resources`      | generate resources for inclusion in the package.                                                                                                        |
| `process-resources`       | copy and process the resources into the destination directory, ready for packaging.                                                                     |
| `compile`                 | compile the source code of the project.                                                                                                                 |
| `process-classes`         | post-process the generated files from compilation, for example to do bytecode enhancement on Java classes.                                              |
| `generate-test-sources`   | generate any test source code for inclusion in compilation.                                                                                             |
| `process-test-sources`    | process the test source code, for example to filter any values.                                                                                         |
| `generate-test-resources` | create resources for testing.                                                                                                                           |
| `process-test-resources`  | copy and process the resources into the test destination directory.                                                                                     |
| `test-compile`            | compile the test source code into the test destination directory                                                                                        |
| `process-test-classes`    | post-process the generated files from test compilation, for example to do bytecode enhancement on Java classes.                                         |
| `test`                    | run tests using a suitable unit testing framework. These tests should not require the code be packaged or deployed.                                     |
| `prepare-package`         | perform any operations necessary to prepare a package before the actual packaging. This often results in an unpacked, processed version of the package. |
| `package`                 | take the compiled code and package it in its distributable format, such as a JAR.                                                                       |
| `pre-integration-test`    | perform actions required before integration tests are executed. This may involve things such as setting up the required environment.                    |
| `integration-test`        | process and deploy the package if necessary into an environment where integration tests can be run.                                                     |
| `post-integration-test`   | perform actions required after integration tests have been executed. This may including cleaning up the environment.                                    |
| `verify`                  | run any checks to verify the package is valid and meets quality criteria.                                                                               |
| `install`                 | install the package into the local repository, for use as a dependency in other projects locally.                                                       |
| `deploy`                  | done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.        |

### Site Lifecycle

| Phase         | Description                                                                                  |
| ------------- | -------------------------------------------------------------------------------------------- |
| `pre-site`    | execute processes needed prior to the actual project site generation                         |
| `site`        | generate the project's site documentation                                                    |
| `post-site`   | execute processes needed to finalize the site generation, and to prepare for site deployment |
| `site-deploy` | deploy the generated site documentation to the specified web server                          |

## 플러그인

Maven에서 플러그인을 실행할 때에는 '`plugin:goal`'의 형식으로 실행할 기능을 선택한다.
예를 들어 `compiler:compile`은 `compiler` 플러그인에서 `compile` 기능(goal)을 실행한다는 것을 뜻한다.

- [Supported By The Maven Project](https://maven.apache.org/plugins/index.html)

## References

- Understanding Apache Maven - foojay
  - [Part 1: Basics](https://foojay.io/today/understanding-apache-maven-part-1-the-basics/)
  - [Part 2: POM Hierarchy and Effective POM](https://foojay.io/today/understanding-apache-maven-part-2-pom-hierarchy/)
  - [Part 3: Maven Coordinates & POM Inheritance](https://foojay.io/today/understanding-apache-maven-part-3-maven-coordinates-pom-inheritance/)
  - [Part 4: Maven Lifecycle](https://foojay.io/today/understanding-apache-maven-part-4-maven-lifecycle/)
  - [Part 5: Dependencies in Maven](https://foojay.io/today/understanding-apache-maven-part-5-dependencies-in-maven/)
  - [Part 6: POM Reference](https://foojay.io/today/understanding-apache-maven-part-6-pom-reference/)
  - [Part 7: Configuring Apache Maven](https://foojay.io/today/understanding-apache-maven-part-7-configuring-apache-maven/)
- [Maven](https://www.baeldung.com/maven) - Baeldung
- [자바 세상의 빌드를 이끄는 메이븐](https://www.aladin.co.kr/shop/wproduct.aspx?ISBN=9788979148138) - 박재성
- [Maven 기초 사용법](https://javacan.tistory.com/entry/MavenBasic) - 자바캔(최범균)
